{% extends 'base.html' %} {% load static %} {% load humanize %}{% block title %} Property Overview {% endblock title %} {% block body %}
<div class="alert alert-success alert-dismissible fade show" style="display: none;" role="alert">
  <span class="message"></span>
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="row">
  <div class="col-md-12">
    <!-- **************Mini Dashbar************************************************** -->
    <div class="row">
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div
          class="card card-stats"
          style="
            background: linear-gradient(to bottom, #eee16a 0%, #ffffff 120%);
          "
        >
          <div class="card-header card-header-warning card-header-icon">
            <div class="card-icon">
              <i class="material-icons">account_balance_wallet</i>
            </div>
            <h3 class="card-title" id="totalCollectedAmount">
              {% if not total_earnings.amount == None %}
                {{ total_earnings.amount|intcomma }}
              {% else %}
                0
              {% endif %}
            </h3>
            <br /><br />
            <p class="card-category">Total Earnings</p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div
          class="card card-stats"
          style="
            background: linear-gradient(to bottom, #fda3c8 0%, #ffffff 120%);
          "
        >
          <div class="card-header card-header-rose card-header-icon">
            <div class="card-icon">
              <i class="material-icons">account_balance_wallet</i>
            </div>
            <h3 class="card-title totalDueAmount"></h3>
            <span class="totalUnitAmounts" style="display: none"
              >{{ all_units_amount.annual_rent__sum }}</span
            >
            <br /><br />
            <p class="card-category">Total Dues Amount</p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div
          class="card card-stats"
          style="
            background: linear-gradient(to bottom, #ffa26c 0%, #ffffff 120%);
          "
        >
          <div class="card-header card-header-success card-header-icon">
            <div class="card-icon">
              <i class="material-icons">home</i>
            </div>
            <h3 class="card-title">{{ number_of_units }}</h3>
            <br /><br />
            <p class="card-category">Total Units</p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div
          class="card card-stats"
          style="
            background: linear-gradient(to bottom, #dd6cff 0%, #ffffff 120%);
          "
        >
          <div class="card-header card-header-info card-header-icon">
            <div class="card-icon">
              <i class="material-icons">vpn_key</i>
            </div>
            <h3 class="card-title">{{ number_of_vacant_units }}</h3>
            <br /><br />
            <p class="card-category">Total Vacant</p>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div
        class="card-header card-header-icon"
        
      >
        <div class="card-icon"style="padding: 0.8em 0; font-size: 1rem; background: rgb(224, 79, 115)">
          <a
            href=""
            class="card-header card-header-text"
            style="font-size: 20px"
          >
            <i class="material-icons">roofing</i> {{ entity }}
          </a>
        </div>
        <div
          class="card-icon float-right"
          style="
            padding: 0.5em 0;
            font-size: 1rem;
            background: rgb(224, 79, 115);
          "
        >
          <a
            href=" {% url 'add_property' entity.entity_name %} "
            class="card-header card-header-rose card-header-text"
          >
            <i class="material-icons">add</i>Add Property
          </a>
        </div>
      </div>
      <div class="card-body">
        <div class="toolbar">
          <!--        Here you can write extra buttons/actions for the toolbar              -->
        </div>
        <div class="material-datatables">
          <table
            id="datatables"
            class="table table-striped table-no-bordered table-hover"
            cellspacing="0"
            width="100%"
            style="width: 100%"
          >
            <thead>
              <tr>
                <th>Owner Name</th>
                <th>Property Name</th>
                <th>Total Earnings</th>
                <th>Total Dues</th>
                <th>Total Units</th>
                <th>Occupancy Graph</th>
                <th class="disabled-sorting text-right">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% if properties %} {% for property in properties %}
              <tr>
                <td>{{ property.owner_name }}</td>
                <td>{{ property.property_name }}</td>
                <td class="collectedAmount">
                  {% for unit in property.unit_set.all %}
                    {% for payment in unit.payment_set.all %}
                      {{ payment.amount|intcomma }}
                    {% endfor %}      
                  {% endfor %}
                </td>
                <span class="totalInEach" style="color: '#ffffff';">
                  {% for unit in property.unit_set.all %}
                    {{unit.tenantcontract.annual_rent }}  
                  {% endfor %}
                </span>
                <td class="dueAmount"></td>
                <td class="text-center">{{ property.unit_set.all.count }}</td>
                <td class="inUnit">
                    
                  <div
                    class="progress progress-line-primary"
                    title="{{ number_of_vacant_units }} / {{ property.unit_set.all.count }} Vacant"
                    style="margin: 0;width: 90%; height: 10px; border-radius: 30px; background:rgb(8, 158, 8)"
                  >
                    <div
                      class="progress-bar progress-bar-danger"
                      role="progressbar"
                      aria-valuenow="{{ percentage }}"
                      aria-valuemin="0"
                      aria-valuemax="100"
                      title="{{ number_of_occupied_units }} / {{ property.unit_set.all.count }} Occupied"
                      style="width: {{ percentage }}%"
                    >
                      <span class="sr-only">{{ percentage }}% Complete</span>
                    </div>
                  </div>
                </td>
                <td class="text-right">
                  <a
                    href=" {% url 'property_unit_overview' property.pk %} "
                    class="d-inline" title="View units"
                    >
                    <div class="ripple-container success"></div>
                    <i
                      class="material-icons"
                      style="
                        margin-right: 08px;
                        margin-top: 10px;
                        margin-bottom: 20px;
                        color: #5b93f6;
                      "
                      >location_city</i
                    >
                  </a>

                  <a href="" class="d-inline" title="View location">
                    
                    <i
                      class="material-icons"
                      style="
                        margin-right: 10px;
                        margin-top: 10px;
                        margin-bottom: 20px;
                        color: #f44336;
                      "
                      >location_on</i
                    >
                    <div class="ripple-container"></div>
                  </a>

                  <a
                    href="{% url 'view_property' property.pk %}"
                    class="d-inline"
                    rel="tooltip "
                    data-original-title="Remove"
                     title="View property"
                    >
                    <div class="ripple-container success"></div>
                    <i
                      class="material-icons"
                      style="
                        margin-right: 10px;
                        margin-top: 10px;
                        margin-bottom: 20px;
                        color: #ff9800;
                      "
                      >dvr</i
                    >
                  </a>

                  <a
                    href="{% url 'update_property' property.pk  %}"
                   title="Update property"
                    class="d-inline"
                    >
                    <div class="ripple-container success"></div>
                    <i
                      class="material-icons"
                      style="
                        margin-right: 5px;
                        margin-top: 10px;
                        margin-bottom: 20px;
                        color: #4caf50;
                      "
                      >create</i
                    >
                  </a>

               
                  {% if request.user.is_superuser %}
                  <a
                      href="#"
                      class="d-inline delete-item btn-delete"
                      title="Delete unit"
                      data-target="#deleteToggle"
                      data-toggle="modal"
                      data-toggle="modal"
                      data-pk="{{property.pk}}" data-name="{{ property.property_name }}"
                    >
                      <i
                        class="material-icons"
                        style="
                          margin-right: 5px;
                          margin-top: 10px;
                          margin-bottom: 20px;
                          color: #c55d55;
                        "
                        >delete</i
                      >
                      <div class="ripple-container"></div>
                  </a>
                {% endif %}
                    
              </td>
            </tr>
              {% endfor %} {% else %} <tr class="text-center"><td colspan="7">No Property</td></tr>  {% endif %}
            </tbody>
          </table>
          <!-- Modal -->
        <div class="modal fade" id="deleteToggle" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
          <div class="modal-dialog modal-dialog-top" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <!-- <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5> -->
                <button type="button" class="close p-3" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-info" data-dismiss="modal">No</button>
                <a href="" type="button" class="btn btn-danger confirmation" data-dismiss="modal">Yes</a>
              </div>
            </div>
          </div>
        </div>
        </div>
      </div>
      <!-- end content-->
    </div>
    <!--  end card  -->
  </div>
  <!-- end col-md-12 -->
</div>
<!-- end row -->

{% block property_overview %}
<script src="{% static 'js/property_overview.js' %}"></script>
{% endblock %}


{% endblock %}
