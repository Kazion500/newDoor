{% extends 'base.html' %} {% load humanize %} {% block title %} Dashboard {% endblock title %} {% block body %}

<div class="row">
  <div class="col-lg-3 col-md-6 col-sm-6">
    <div class="card card-stats">
      <div class="card-header card-header-warning card-header-icon">
        <div class="card-icon">
          <i class="material-icons">account_balance_wallet</i>
        </div>
        <h3 class="card-title">
          {% if total_payments.amount != None %}
            ${{ total_payments.amount|intcomma }}
          {% else %}
            0
          {% endif %}
        </h3>
        <br /><br />
        <b class="card-category">Total Earnings</b>
      </div>
    </div>
  </div>
  <div class="col-lg-3 col-md-6 col-sm-6">
    <div class="card card-stats">
      <div class="card-header card-header-rose card-header-icon">
        <div class="card-icon">
          <i class="material-icons">account_balance_wallet</i>
        </div>
        <h3 class="card-title">
          {% if due_payments.due != None %}
            ${{ due_payments.due|intcomma }}
          {% else %}
            0
          {% endif %}
        </h3>
        <br /><br />
        <b class="card-category">Total Dues Amount</b>
      </div>
    </div>
  </div>
  <div class="col-lg-3 col-md-6 col-sm-6">
    <div class="card card-stats">
      <div class="card-header card-header-success card-header-icon">
        <div class="card-icon">
          <i class="material-icons">home</i>
        </div>
        <h3 class="card-title">{{ total_num_units }}</h3>
        <br /><br />
        <b class="card-category">Total Units</b>
      </div>
    </div>
  </div>
  <div class="col-lg-3 col-md-6 col-sm-6">
    <div class="card card-stats">
      <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
          <i class="material-icons">vpn_key</i>
        </div>
        <h3 class="card-title">{{ vacant_units }}</h3>
        <br /><br />
        <b class="card-category">Total Vacant</b>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-4">
    <div class="card card-chart" data-count="2">
      <div class="card-header card-header-rose" data-header-animation="true">
        <div class="ct-chart" id="websiteViewsChart">
          <svg
            xmlns:ct="http://gionkunz.github.com/chartist-js/ct"
            width="100%"
            height="100%"
            class="ct-chart-bar"
            style="width: 100%; height: 100%"
          >
            <g class="ct-grids">
              <line
                y1="120"
                y2="120"
                x1="40"
                x2="258"
                class="ct-grid ct-vertical"
              ></line>
              <line
                y1="96"
                y2="96"
                x1="40"
                x2="258"
                class="ct-grid ct-vertical"
              ></line>
              <line
                y1="72"
                y2="72"
                x1="40"
                x2="258"
                class="ct-grid ct-vertical"
              ></line>
              <line
                y1="48"
                y2="48"
                x1="40"
                x2="258"
                class="ct-grid ct-vertical"
              ></line>
              <line
                y1="24"
                y2="24"
                x1="40"
                x2="258"
                class="ct-grid ct-vertical"
              ></line>
              <line
                y1="0"
                y2="0"
                x1="40"
                x2="258"
                class="ct-grid ct-vertical"
              ></line>
            </g>
            <g>
              <g class="ct-series ct-series-a">
                <line
                  x1="49.083333333333336"
                  x2="49.083333333333336"
                  y1="120"
                  y2="54.959999999999994"
                  class="ct-bar"
                  ct:value="542"
                  opacity="1"
                ></line>
                <line
                  x1="67.25"
                  x2="67.25"
                  y1="120"
                  y2="66.84"
                  class="ct-bar"
                  ct:value="443"
                  opacity="1"
                ></line>
                <line
                  x1="85.41666666666667"
                  x2="85.41666666666667"
                  y1="120"
                  y2="81.6"
                  class="ct-bar"
                  ct:value="320"
                  opacity="1"
                ></line>
                <line
                  x1="103.58333333333333"
                  x2="103.58333333333333"
                  y1="120"
                  y2="26.400000000000006"
                  class="ct-bar"
                  ct:value="780"
                  opacity="1"
                ></line>
                <line
                  x1="121.75"
                  x2="121.75"
                  y1="120"
                  y2="53.64"
                  class="ct-bar"
                  ct:value="553"
                  opacity="1"
                ></line>
                <line
                  x1="139.91666666666669"
                  x2="139.91666666666669"
                  y1="120"
                  y2="65.64"
                  class="ct-bar"
                  ct:value="453"
                  opacity="1"
                ></line>
                <line
                  x1="158.08333333333334"
                  x2="158.08333333333334"
                  y1="120"
                  y2="80.88"
                  class="ct-bar"
                  ct:value="326"
                  opacity="1"
                ></line>
                <line
                  x1="176.25000000000003"
                  x2="176.25000000000003"
                  y1="120"
                  y2="67.92"
                  class="ct-bar"
                  ct:value="434"
                  opacity="1"
                ></line>
                <line
                  x1="194.41666666666669"
                  x2="194.41666666666669"
                  y1="120"
                  y2="51.84"
                  class="ct-bar"
                  ct:value="568"
                  opacity="1"
                ></line>
                <line
                  x1="212.58333333333334"
                  x2="212.58333333333334"
                  y1="120"
                  y2="46.8"
                  class="ct-bar"
                  ct:value="610"
                  opacity="1"
                ></line>
                <line
                  x1="230.75000000000003"
                  x2="230.75000000000003"
                  y1="120"
                  y2="29.28"
                  class="ct-bar"
                  ct:value="756"
                  opacity="1"
                ></line>
                <line
                  x1="248.91666666666669"
                  x2="248.91666666666669"
                  y1="120"
                  y2="12.599999999999994"
                  class="ct-bar"
                  ct:value="895"
                  opacity="1"
                ></line>
              </g>
            </g>
            <g class="ct-labels">
              <foreignObject
                style="overflow: visible"
                x="40"
                y="125"
                width="18.166666666666668"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >J</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="58.16666666666667"
                y="125"
                width="18.166666666666668"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >F</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="76.33333333333334"
                y="125"
                width="18.166666666666664"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >M</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="94.5"
                y="125"
                width="18.16666666666667"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >A</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="112.66666666666667"
                y="125"
                width="18.16666666666667"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >M</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="130.83333333333334"
                y="125"
                width="18.166666666666657"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >J</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="149"
                y="125"
                width="18.16666666666667"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >J</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="167.16666666666669"
                y="125"
                width="18.16666666666667"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >A</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="185.33333333333334"
                y="125"
                width="18.166666666666657"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >S</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="203.5"
                y="125"
                width="18.166666666666686"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >O</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="221.66666666666669"
                y="125"
                width="18.166666666666657"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 18px; height: 20px"
                  >N</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                x="239.83333333333334"
                y="125"
                width="30"
                height="20"
                ><span
                  class="ct-label ct-horizontal ct-end"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="width: 30px; height: 20px"
                  >D</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                y="96"
                x="0"
                height="24"
                width="30"
                ><span
                  class="ct-label ct-vertical ct-start"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="height: 24px; width: 30px"
                  >0</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                y="72"
                x="0"
                height="24"
                width="30"
                ><span
                  class="ct-label ct-vertical ct-start"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="height: 24px; width: 30px"
                  >200</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                y="48"
                x="0"
                height="24"
                width="30"
                ><span
                  class="ct-label ct-vertical ct-start"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="height: 24px; width: 30px"
                  >400</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                y="24"
                x="0"
                height="24"
                width="30"
                ><span
                  class="ct-label ct-vertical ct-start"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="height: 24px; width: 30px"
                  >600</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                y="0"
                x="0"
                height="24"
                width="30"
                ><span
                  class="ct-label ct-vertical ct-start"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="height: 24px; width: 30px"
                  >800</span
                ></foreignObject
              ><foreignObject
                style="overflow: visible"
                y="-30"
                x="0"
                height="30"
                width="30"
                ><span
                  class="ct-label ct-vertical ct-start"
                  xmlns="http://www.w3.org/2000/xmlns/"
                  style="height: 30px; width: 30px"
                  >1000</span
                ></foreignObject
              >
            </g>
          </svg>
        </div>
      </div>
      <div class="card-body">
        <div class="card-actions">
          <button type="button" class="btn btn-danger btn-link fix-broken-card">
            <i class="material-icons">build</i> Fix Header!
          </button>
          <button
            type="button"
            class="btn btn-info btn-link"
            rel="tooltip"
            data-placement="bottom"
            title=""
            data-original-title="Refresh"
          >
            <i class="material-icons">refresh</i>
          </button>
          <button
            type="button"
            class="btn btn-default btn-link"
            rel="tooltip"
            data-placement="bottom"
            title=""
            data-original-title="Change Date"
          >
            <i class="material-icons">edit</i>
          </button>
        </div>
        <h4 class="card-title"><strong>Online Payment</strong></h4>
        <p class="card-category">Last Campaign Performance</p>
      </div>
      <!-- <div class="card-footer">
                <div class="stats">
                    <i class="material-icons">access_time</i> campaign sent 2 days ago
                </div>
            </div> -->
    </div>
  </div>
  <div class="col-md-8">
    <div class="card">
      <div class="card-header card-header-warning card-header-icon">
        <div class="card-icon">
          <i class="material-icons" style="width: initial">account_balance</i>
        </div>
        <h4 class="card-title">4 Top Property</h4>
      </div>
      <div class="card-body">
        <div class="toolbar">
          <!--        Here you can write extra buttons/actions for the toolbar              -->
        </div>
        <div class="material-datatables">
          <div id="datatables_wrapper" class="dataTables_wrapper dt-bootstrap4">
            <div class="row">
              <div class="col-sm-12">
                <table
                  id="datatables"
                  class="table table-striped table-no-bordered table-hover dataTable dtr-inline"
                  cellspacing="0"
                  width="100%"
                  style="width: 100%"
                  role="grid"
                  aria-describedby="datatables_info"
                >
                  <thead>
                    <tr role="row">
                      <th
                        class="sorting_asc"
                        tabindex="0"
                        aria-controls="datatables"
                        rowspan="1"
                        colspan="1"
                        style="width: 135px"
                        aria-sort="ascending"
                        aria-label="Name: activate to sort column descending"
                      >
                        Property Name
                      </th>
                      <th
                        class="sorting"
                        tabindex="0"
                        aria-controls="datatables"
                        rowspan="1"
                        colspan="1"
                        style="width: 77px"
                        aria-label="Age: activate to sort column ascending"
                      >
                        Units
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {% if properties %} {% for property in properties %}
                    <tr role="row" class="odd">
                      <th tabindex="0" class="sorting_1">
                        {{property.property_name}}
                      </th>
                      <td>{{ property.unit_set.all.count }}</td>
                    </tr>
                    {% endfor %} {% else %}
                    <tr class="text-center">
                      <td colspan="5">No Properties yet</td>
                    </tr>
                    {% endif %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- end content-->
    </div>
    <!--  end card  -->
  </div>
</div>
<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header card-header-primary card-header-icon">
        <div class="card-icon">
          <i class="material-icons" style="width: initial">account_balance</i>
        </div>
        <h4 class="card-title">Latest 10 Paid Invoices</h4>
      </div>
      <div class="card-body">
        <div class="toolbar">
          <!--        Here you can write extra buttons/actions for the toolbar              -->
        </div>
        <div class="row">
          <div class="col-sm-12">
            <div class="material-datatables">
              <table
                id="datatables"
                class="table table-striped table-no-bordered table-hover"
                cellspacing="0"
                width="100%"
                style="width: 100%"
              >
                <thead>
                  <tr>
                    <th>Paid amount</th>
                    <th>Due amount</th>
                    <th>Date</th>
                    <th>Next Payment Date</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {% if tenant_payments %} 
                  {% for payment in tenant_payments %}
                  <tr>
                    <td>{{ payment.amount|intcomma }}</td>
                    <td>{{ payment.remain_amount }}</td>
                    <td>{{ payment.paid_date|date:'d F Y' }}</td>
                    <td>{{ payment.paid_date|date:'d F Y' }}</td>
                    <td class="text-center">
                      <span class="badge badge-success badge-pill"
                        >{{ payment.status }}</span
                      >
                    </td>
                    <td class="text-center">
                      <a
                        href="#"
                        ><i class="material-icons">dvr</i></a
                      >
                    </td>
                  </tr>
                  {% endfor %} 
                  {% else %}
                  <tr class="text-center">
                    <td colspan="6">No payments yet</td>
                  </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- end content-->
    </div>
    <!--  end card  -->
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header card-header-danger card-header-icon">
        <div class="card-icon">
          <i class="material-icons" style="width: initial">assignment</i>
        </div>
        <h4 class="card-title">Notification</h4>
      </div>
      <div class="card-body">
        {% if units.count > 0 %} {% if unit.tenantcontract.count > 0 %} 
        {% for unit in units %} {% if unit.occupancy_type.occupancy_type.lower == 'create contract' %}
        <div class="mgs d-flex mt-2">
          <i class="material-icons pr-2 text-danger"> feedback </i>
          <a
            href="{% url 'add_tetant_contract' unit.tenantcontract.tenant.user.username %}"
            style="font-weight: 600"
            class="link text-dark"
            >A Contract needs to be created for unit flat
            <span class="text-success">{{unit.flat}}</span>
          </a>
        </div>
        {% else %}
        <p class="text-center" style="font-weight: 600">No notifications</p>
        {% endif %} {% endfor %} {% else %}
        <p class="text-center" style="font-weight: 600">No notifications</p>
        {% endif %} {% else %}
        <p class="text-center" style="font-weight: 600">No notifications</p>
        {% endif %}
      </div>
      <!-- end content-->
    </div>
    <!--  end card  -->
  </div>
  <!-- end col-md-12 -->
</div>
{% endblock %}
